<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The `mvp` package: fast multivariate polynomials in R • mvp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The `mvp` package: fast multivariate polynomials in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mvp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/mvp.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinHankin/mvp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The `mvp` package: fast multivariate polynomials in R</h1>
                        <h4 data-toc-skip class="author">Robin K. S.
Hankin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RobinHankin/mvp/blob/master/vignettes/mvp.Rmd" class="external-link"><code>vignettes/mvp.Rmd</code></a></small>
      <div class="d-none name"><code>mvp.Rmd</code></div>
    </div>

    
    
<p><img src="../../../_temp/Library/mvp/help/figures/mvp.png" class="r-plt" alt="" width="20%" style="float:right; padding:10px"></p>
<p>To cite the <code>mvp</code> package in publications please use <span class="citation">Hankin (<a href="#ref-hankin2022_mvp">2022b</a>)</span>. Multivariate polynomials
are interesting and useful objects, with a wide range of applications.
The <code>mvp</code> package provides some functionality for fast
manipulation of multivariate polynomials, using the Standard Template
library of <code>C++</code> <span class="citation">(<a href="#ref-stroustrup1997">Stroustrup 1997</a>)</span>, commonly known
as the <code>STL</code>. It is comparable in speed to the
<code>spray</code> package for sparse arrays, while retaining the
symbolic capabilities of the <code>mpoly</code> package <span class="citation">(<a href="#ref-kahle2013">Kahle 2013</a>)</span>. I
present some timing results separately, in
<code>inst/timings.Rmd</code>. The <code>mvp</code> package uses the
excellent print and coercion methods of <code>mpoly</code>. The
<code>mvp</code> package provides improved speed over
<code>mpoly</code>, the ability to handle negative powers, and a more
sophisticated substitution mechanism.</p>
<div class="section level2">
<h2 id="the-stl-map-class">The <code>STL map</code> class<a class="anchor" aria-label="anchor" href="#the-stl-map-class"></a>
</h2>
<p>A <code>map</code> is a sorted associative container that contains
key-value pairs with unique keys. It is interesting here because search
and insertion operations have logarithmic complexity. Multivariate
polynomials are considered to be the sum of a finite number of
<em>terms</em>, each multiplied by a coefficient. A <em>term</em> is
something like
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><msup><mi>y</mi><mn>3</mn></msup><mi>z</mi></mrow><annotation encoding="application/x-tex">x^2y^3z</annotation></semantics></math>.
We may consider this term to be the map</p>
<pre><code>{"x" -&gt; 2, "y" -&gt; 3, "z" -&gt; 1}</code></pre>
<p>where the map takes symbols to their (integer) power; it is
understood that powers are nonzero. An <code>mvp</code> object is a map
from terms to their coefficients; thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn><mi>x</mi><msup><mi>y</mi><mn>2</mn></msup><mo>−</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mi>y</mi><msup><mi>z</mi><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">7xy^2 -3x^2yz^5</annotation></semantics></math>
would be</p>
<pre><code>{{"x" -&gt; 1, "y" -&gt; 2} -&gt; 7, {"x" -&gt; 2, 'y" -&gt; 1, "z" -&gt;5} -&gt; -3}</code></pre>
<p>and we understand that coefficients are nonzero. In <code>C++</code>
the declarations would be</p>
<pre><code>typedef vector &lt;signed int&gt; mypowers;  
typedef vector &lt;string&gt; mynames;  

typedef map &lt;string, signed int&gt; term; 
typedef map &lt;term, double&gt; mvp; </code></pre>
<p>Thus a <code>term</code> maps a string to a (signed) integer, and a
<code>mvp</code> maps terms to doubles. One reason why the
<code>map</code> class is fast is that the order in which the keys are
stored is undefined: the compiler may store them in the order which it
regards as most propitious. This is not an issue for the maps considered
here as addition and multiplication are commutative and associative.</p>
<p>Note also that constant terms are handled with no difficulty
(constants are simply maps from the empty map to its value), as is the
zero polynomial (which is simply an empty map).</p>
<div class="section level3">
<h3 id="the-package-in-use">The package in use<a class="anchor" aria-label="anchor" href="#the-package-in-use"></a>
</h3>
<p>Consider a simple multivariate polynomial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>x</mi><mi>y</mi><mo>+</mo><msup><mi>z</mi><mn>3</mn></msup><mo>+</mo><mi>x</mi><msup><mi>y</mi><mn>6</mn></msup><mi>z</mi></mrow><annotation encoding="application/x-tex">3xy+z^3+xy^6z</annotation></semantics></math>
and its representation in the following R session:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RobinHankin/mvp" class="external-link">"mvp"</a></span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://magrittr.tidyverse.org" class="external-link">"magrittr"</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"3 x y + z^3 + x y^6 z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 3 x y + x y^6 z + z^3</span></span></code></pre></div>
<p>Coercion and printing are accomplished by the <code>mpoly</code>
package (there is no way I could improve upon Kahle’s work). Note
carefully that the printed representation of the mvp object is created
by the <code>mpoly</code> package and the print method can rearrange
both the terms of the polynomial
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>x</mi><mi>y</mi><mo>+</mo><msup><mi>z</mi><mn>3</mn></msup><mo>+</mo><mi>x</mi><msup><mi>y</mi><mn>6</mn></msup><mi>z</mi><mo>=</mo><msup><mi>z</mi><mn>3</mn></msup><mo>+</mo><mn>3</mn><mi>x</mi><mi>y</mi><mo>+</mo><mi>x</mi><msup><mi>y</mi><mn>6</mn></msup><mi>z</mi></mrow><annotation encoding="application/x-tex">3xy+z^3+xy^6z = z^3+3xy+xy^6z</annotation></semantics></math>,
for example) and the symbols within a term
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>x</mi><mi>y</mi><mo>=</mo><mn>3</mn><mi>y</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">3xy=3yx</annotation></semantics></math>,
for example) to display the polynomial in a human-friendly form.</p>
<p>However, note carefully that such rearranging does not affect the
mathematical properties of the polynomial itself. In the
<code>mvp</code> package, the order of the terms is not preserved (or
even defined) in the internal representation of the object; and neither
is the order of the symbols within a single term. Although this might
sound odd, if we consider a marginally more involved situation, such
as</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"3 stoat goat^6 -4 + 7 stoatboat^3 bloat -9 float boat goat gloat^6"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; -4 + 7 bloat stoatboat^3 - 9 boat float gloat^6 goat + 3 goat^6 stoat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; structure(list(names = list(character(0), c("bloat", "stoatboat"</span></span>
<span><span class="co">#&gt; ), c("boat", "float", "gloat", "goat"), c("goat", "stoat")), </span></span>
<span><span class="co">#&gt;     power = list(integer(0), c(1L, 3L), c(1L, 1L, 6L, 1L), c(6L, </span></span>
<span><span class="co">#&gt;     1L)), coeffs = c(-4, 7, -9, 3), "a42fbf7de80773710e0bf126ddb55cd6ece4a8dc"), class = "mvp")</span></span></code></pre></div>
<p>it is not clear that any human-discernible ordering is preferable to
any other, and we would be better off letting the compiler decide a
propitious ordering. In any event, the <code>mpoly</code> package can
specify a print order:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">M</span>,order<span class="op">=</span><span class="st">"lex"</span>, varorder<span class="op">=</span><span class="fu"><a href="../reference/letters.html">c</a></span><span class="op">(</span><span class="st">"stoat"</span>,<span class="st">"goat"</span>,<span class="st">"boat"</span>,<span class="st">"bloat"</span>,<span class="st">"gloat"</span>,<span class="st">"float"</span>,<span class="st">"stoatboat"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 3 stoat goat^6 - 9 goat boat gloat^6 float + 7 bloat stoatboat^3 - 4</span></span></code></pre></div>
<p>Note in passing that variable names may be any character string, not
just single letters.</p>
</div>
<div class="section level3">
<h3 id="arithmetic-operations">Arithmetic operations<a class="anchor" aria-label="anchor" href="#arithmetic-operations"></a>
</h3>
<p>The arithmetic operations <code>*</code>, <code>+</code>,
<code>-</code> and <code>^</code> work as expected:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmvp.html">rmvp</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 12 + 9 b d</span></span>
<span><span class="op">(</span><span class="va">S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmvp.html">rmvp</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 2 a + b d + 3 c + c d</span></span>
<span><span class="va">S1</span> <span class="op">+</span> <span class="va">S2</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 13 + 2 a + 10 b d + 3 c + c d</span></span>
<span><span class="va">S1</span> <span class="op">*</span> <span class="va">S2</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 12 + 24 a + 18 a b d + 27 b c d + 9 b c d^2 + 21 b d + 9 b^2 d^2 + 36 c + 12 c</span></span>
<span><span class="co">#&gt; d</span></span>
<span><span class="va">S1</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 144 + 216 b d + 81 b^2 d^2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="substitution">Substitution<a class="anchor" aria-label="anchor" href="#substitution"></a>
</h3>
<p>The package has two substitution functionalities. Firstly, we can
substitute one or more variables for a numeric value. Define a mvp
object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">S3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"x + 5 x^4 y + 8 y^2 x z^3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; x + 8 x y^2 z^3 + 5 x^4 y</span></span></code></pre></div>
<p>And then we may substitute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x=1</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span><span class="va">S3</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 5 y + 8 y^2 z^3</span></span></code></pre></div>
<p>Note the natural R idiom, and that the return value is another mvp
object. We may substitute for the other variables:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span><span class="va">S3</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span>, z <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 875</span></span></code></pre></div>
<p>(in this case, the default behaviour is to return the resulting
polynomial coerced to a scalar). We can suppress the coercion using the
<code>drop</code> (formerly <code>lose</code>) argument:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span><span class="va">S3</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span>, z <span class="op">=</span> <span class="fl">3</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 875</span></span></code></pre></div>
<p>The idiom also allows one to substitute a variable for an
<code>mvp</code> object:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span><span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"a+b+c"</span><span class="op">)</span>, a<span class="op">=</span><span class="st">"x^6"</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; b + c + x^6</span></span></code></pre></div>
<p>Note carefully that <code><a href="../reference/subs.html">subs()</a></code> depends on the order of
substitution:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span><span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"a+b+c"</span><span class="op">)</span>, a<span class="op">=</span><span class="st">"x^6"</span>,x<span class="op">=</span><span class="st">"1+a"</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 6 a + 15 a^2 + 20 a^3 + 15 a^4 + 6 a^5 + a^6 + b + c</span></span>
<span><span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span><span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"a+b+c"</span><span class="op">)</span>, x<span class="op">=</span><span class="st">"1+a"</span>,a<span class="op">=</span><span class="st">"x^6"</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; b + c + x^6</span></span></code></pre></div>
<div class="section level4">
<h4 id="pipes">Pipes<a class="anchor" aria-label="anchor" href="#pipes"></a>
</h4>
<p>Substitution works well with pipes:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"a+b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>a<span class="op">=</span><span class="st">"a^2+b^2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>b<span class="op">=</span><span class="st">"x^6"</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; a^2 + x^6 + x^12</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="vectorised-substitution">Vectorised substitution<a class="anchor" aria-label="anchor" href="#vectorised-substitution"></a>
</h3>
<p>Function <code><a href="../reference/subs.html">subvec()</a></code> allows one to substitute variables for
numeric values using vectorised idiom:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmvp.html">rmvp</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 6 a^2 + 3 b + 2 b c + 2 c</span></span>
<span><span class="fu"><a href="../reference/subs.html">subvec</a></span><span class="op">(</span><span class="va">p</span>,a<span class="op">=</span><span class="fl">1</span>,b<span class="op">=</span><span class="fl">2</span>,c<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>   <span class="co"># supply a named list of vectors</span></span>
<span><span class="co">#&gt; [1] 19 25 31 37 43</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="differentiation">Differentiation<a class="anchor" aria-label="anchor" href="#differentiation"></a>
</h3>
<p>Differentiation is implemented. First we have the
<code><a href="../reference/deriv.html">deriv()</a></code> method:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"a + 5 a^5*b^2*c^8 -3 x^2 a^3 b c^3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; a - 3 a^3 b c^3 x^2 + 5 a^5 b^2 c^8</span></span>
<span><span class="fu"><a href="../reference/deriv.html">deriv</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; -27 a^2 c^2 x^2 + 400 a^4 b c^7</span></span>
<span><span class="fu"><a href="../reference/deriv.html">deriv</a></span><span class="op">(</span><span class="va">S</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="co"># should be the same.</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; -27 a^2 c^2 x^2 + 400 a^4 b c^7</span></span></code></pre></div>
<p>Also a slightly different form: <code><a href="../reference/deriv.html">aderiv()</a></code>, here used to
evaluate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><msup><mi>∂</mi><mn>6</mn></msup><mi>S</mi></mrow><mrow><mi>∂</mi><msup><mi>a</mi><mn>3</mn></msup><mi>∂</mi><mi>b</mi><mi>∂</mi><msup><mi>c</mi><mn>2</mn></msup></mrow></mfrac><annotation encoding="application/x-tex">\frac{\partial^6S}{\partial a^3\partial b\partial c^2}</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/deriv.html">aderiv</a></span><span class="op">(</span><span class="va">S</span>, a <span class="op">=</span> <span class="fl">3</span>, b <span class="op">=</span> <span class="fl">1</span>, c <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 33600 a^2 b c^6 - 108 c x^2</span></span></code></pre></div>
<p>Again, pipes work quite nicely:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/deriv.html">aderiv</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span>,b<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>c<span class="op">=</span><span class="st">"x^4"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">`+`</span><span class="op">(</span><span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"o^99"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">S</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 50 a^4 x^32 + o^99</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="taylor-series">Taylor series<a class="anchor" aria-label="anchor" href="#taylor-series"></a>
</h3>
<p>The package includes functionality to deal with Taylor and Laurent
series:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"1+x+x^2 y"</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 3 x + 3 x^2 + 3 x^2 y + x^3 + 6 x^3 y + 3 x^4 y + 3 x^4 y^2 + 3 x^5 y^2 +</span></span>
<span><span class="co">#&gt; x^6 y^3</span></span>
<span><span class="fu"><a href="../reference/series.html">trunc</a></span><span class="op">(</span><span class="va">X</span>,<span class="fl">3</span><span class="op">)</span>         <span class="co"># truncate, retain only terms with total power &lt;= 3</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 3 x + 3 x^2 + 3 x^2 y + x^3</span></span>
<span><span class="fu"><a href="../reference/series.html">trunc1</a></span><span class="op">(</span><span class="va">X</span>,x<span class="op">=</span><span class="fl">3</span><span class="op">)</span>    <span class="co"># truncate, retain only terms with  power of x &lt;= 3</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 3 x + 3 x^2 + 3 x^2 y + x^3 + 6 x^3 y</span></span>
<span><span class="fu"><a href="../reference/series.html">onevarpow</a></span><span class="op">(</span><span class="va">X</span>,x<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co"># retain only terms with power of x == 3</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + 6 y</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## second order taylor expansion of f(x)=sin(x+y) for x=1.1, about x=1:</span></span>
<span><span class="va">sinxpy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/horner.html">horner</a></span><span class="op">(</span><span class="st">"x+y"</span>,<span class="fu"><a href="../reference/letters.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">0</span>,<span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="fl">120</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">5040</span><span class="op">)</span><span class="op">)</span>  <span class="co"># sin(x+y)</span></span>
<span><span class="va">dx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"dx"</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="va">sinxpy</span>  <span class="op">+</span> <span class="fu"><a href="../reference/deriv.html">aderiv</a></span><span class="op">(</span><span class="va">sinxpy</span>,x<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">dx</span> <span class="op">+</span> <span class="fu"><a href="../reference/deriv.html">aderiv</a></span><span class="op">(</span><span class="va">sinxpy</span>,x<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">dx</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="op">(</span><span class="va">t2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span>,dx<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># (Taylor expansion of sin(y+1.1), left in symbolic form)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 0.8912877 + 0.4534028 y - 0.4458333 y^2 - 0.07597222 y^3 + 0.03659722 y^4 +</span></span>
<span><span class="co">#&gt; 0.003291667 y^5 - 0.001527778 y^6 - 0.0001984127 y^7</span></span>
<span><span class="op">(</span><span class="va">t2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>y<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>  <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">1.4</span><span class="op">)</span>  <span class="co"># numeric; should be small</span></span>
<span><span class="co">#&gt; [1] -1.416914e-05</span></span></code></pre></div>
<p>Function <code><a href="../reference/series.html">series()</a></code> will decompose an <code>mvp</code>
object into a power series in a single variable:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"a^2 x b + x^2 a b + b c x^2 + a b c + c^6 x"</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; a b c + a b x^2 + a^2 b x + b c x^2 + c^6 x</span></span>
<span><span class="fu"><a href="../reference/series.html">series</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'x'</span><span class="op">)</span></span>
<span><span class="co">#&gt; x^0(a b c )  + x^1(a^2 b  +  c^6 )  + x^2(a b  +  b c )</span></span></code></pre></div>
<p>This works nicely with <code><a href="../reference/subs.html">subs()</a></code> if we wish to take a power
series about <code>x-v</code>, where <code>v</code> is any
<code>mvp</code> object. For example:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"xmv+a+b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/series.html">series</a></span><span class="op">(</span><span class="st">"xmv"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; xmv^0(a b c  +  2 a b^2 c  +  a b^3  +  a c^6  +  a^2 b c  +  3 a^2 b^2  +  2 </span></span>
<span><span class="co">#&gt; a^3 b  +  b c^6  +  b^3 c )  + xmv^1(2 a b c  +  2 a b^2  +  3 a^2 b  +  2 b^2 </span></span>
<span><span class="co">#&gt; c  +  c^6 )  + xmv^2(a b  +  b c )</span></span></code></pre></div>
<p>is a series in powers of <code>x-a-b</code>. We may perform a
consistency check by a second substitution, returning us to the original
expression:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">==</span> <span class="va">p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"xmv+a+b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>xmv<span class="op">=</span><span class="st">"x-a-b"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>If function <code><a href="../reference/series.html">series()</a></code> is given a variable name ending in
<code>_m_foo</code>, where <code>foo</code> is any variable name, then
this is typeset as <code>(x-foo)</code>. For example:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">'x^3 + x*a'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"x_m_a + a"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/series.html">series</a></span><span class="op">(</span><span class="st">"x_m_a"</span><span class="op">)</span></span>
<span><span class="co">#&gt; (x-a)^0(a^2  +  a^3 )  + (x-a)^1(a  +  3 a^2 )  + (x-a)^2(3 a )  + (x-a)^3(1)</span></span></code></pre></div>
<p>So above we see the expansion of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">x^3+ax</annotation></semantics></math>
in powers of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>−</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">x-a</annotation></semantics></math>.
If we want to see the expansion of a mvp in terms of a more complicated
expression then it is better to use a nonce variable <code>v</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">'x^2 + x*a + b^3'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/subs.html">subs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"x_m_v + a^2+b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/series.html">series</a></span><span class="op">(</span><span class="st">"x_m_v"</span><span class="op">)</span></span>
<span><span class="co">#&gt; (x-v)^0(a b  +  2 a^2 b  +  a^3  +  a^4  +  b^2  +  b^3 )  + (x-v)^1(a  +  2 </span></span>
<span><span class="co">#&gt; a^2  +  2 b )  + (x-v)^2(1)</span></span></code></pre></div>
<p>where it is understood that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mi>a</mi><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">v=a+b^2</annotation></semantics></math>.
Function <code><a href="../reference/series.html">taylor()</a></code> is a convenience wrapper that does some
of the above in one step:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"1+x-x*y+a"</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/series.html">taylor</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">'x'</span>,<span class="st">'a'</span><span class="op">)</span></span>
<span><span class="co">#&gt; (x-a)^0(1  +  4 a  -  2 a y  +  4 a^2  -  4 a^2 y  +  a^2 y^2 )  + (x-a)^1(2  + </span></span>
<span><span class="co">#&gt;  4 a  -  6 a y  +  2 a y^2  -  2 y )  + (x-a)^2(1  -  2 y  +  y^2 )</span></span></code></pre></div>
<p>But it’s not as good as I expected it to be and frankly it’s
overkill.</p>
</div>
<div class="section level3">
<h3 id="extraction">Extraction<a class="anchor" aria-label="anchor" href="#extraction"></a>
</h3>
<p>Given a multivariate polynomial, one often needs to extract certain
terms. Because the terms of an <code>mvp</code> object have an
implementation-dependent order, this can be difficult. But we can use
function <code><a href="../reference/series.html">onevarpow()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"1 + z + y^2 + x*z^2 +  x*y"</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span></span>
<span><span class="fu"><a href="../reference/series.html">onevarpow</a></span><span class="op">(</span><span class="va">P</span>,x<span class="op">=</span><span class="fl">1</span>,y<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 12 z^2 + 24 z^3 + 12 z^4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="negative-powers">Negative powers<a class="anchor" aria-label="anchor" href="#negative-powers"></a>
</h3>
<p>The <code>mvp</code> package handles negative powers, although the
idiom is not perfect and I’m still working on it. There is the
<code><a href="../reference/invert.html">invert()</a></code> function:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"1+x+x^2 y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + x + x^2 y</span></span>
<span><span class="fu"><a href="../reference/invert.html">invert</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + x^-2 y^-1 + x^-1</span></span></code></pre></div>
<p>In the above, <code>p</code> is a regular multivariate polynomial
which includes negative powers. It obeys the same arithmetic rules as
other mvp objects:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"z^6"</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 + x + x^2 y + z^6</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-disordr-package">The <code>disordR</code> package<a class="anchor" aria-label="anchor" href="#the-disordr-package"></a>
</h2>
<p>It is possible to examine the coefficients of an <code>mvp</code>
object:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"5 + 8*x^2*y - 13*y*x^2 + 11*z - 3*x*yz"</span><span class="op">)</span></span>
<span><span class="va">a</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 5 - 3 x yz - 5 x^2 y + 11 z</span></span>
<span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="co">#&gt; A disord object with hash b0695ec1b46bb6da92f016f17e49971e1036d786 and elements</span></span>
<span><span class="co">#&gt; [1]  5 -3 -5 11</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>Above, note that the result of <code><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs()</a></code> is a
<code>disord</code> object, defined in the <code>disordR</code> package
<span class="citation">(<a href="#ref-hankin2022_disordR">Hankin
2022a</a>)</span>. The order of the elements unspecified as the
<code>STL map</code> class holds the keys and values in an
implementation-specific order. This device stops the user from illegal
operations on the coefficients. For example, suppose we had another
<code>mvp</code> object, <code>b</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">*</span><span class="fl">2</span></span>
<span><span class="va">b</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 10 - 6 x yz - 10 x^2 y + 22 z</span></span>
<span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="co">#&gt; coeffs(a) + coeffs(b)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `check_matching_hash()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> </span></span>
<span><span class="co">#&gt; hash codes b0695ec1b46bb6da92f016f17e49971e1036d786 and 286de701fbfc3887e4489c2b07127f0811071f43 do not match</span></span></code></pre></div>
<p>above, we get an error because the coefficients of <code>a</code> and
<code>b</code> are possibly stored in a different order and therefore
vector addition makes no sense. However, we can operate on coefficients
of a single <code>mvp</code> object at will:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span><span class="co">#&gt; A disord object with hash b0695ec1b46bb6da92f016f17e49971e1036d786 and elements</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE FALSE  TRUE</span></span>
<span><span class="co">#&gt; (in some order)</span></span>
<span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span></span>
<span><span class="co">#&gt; A disord object with hash b0695ec1b46bb6da92f016f17e49971e1036d786 and elements</span></span>
<span><span class="co">#&gt; [1]   630    78   620 14652</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>Extraction also works but subject to standard <code>disordR</code>
idiom restrictions:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="co">#&gt; A disord object with hash 54f03094a678b0e4328942e555e5a308c29f40fe and elements</span></span>
<span><span class="co">#&gt; [1]  5 11</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>But “mixing” objects is forbidden:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="co">#&gt; .local(x = x, i = i, j = j, drop = drop)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `check_matching_hash()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> </span></span>
<span><span class="co">#&gt; hash codes b0695ec1b46bb6da92f016f17e49971e1036d786 and 286de701fbfc3887e4489c2b07127f0811071f43 do not match</span></span></code></pre></div>
<p>Extraction methods work, again subject to <code>disordR</code>
restrictions:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1000</span> <span class="co"># add 1000 to every negative coefficient</span></span>
<span><span class="va">a</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 5 + 997 x yz + 995 x^2 y + 11 z</span></span></code></pre></div>
<p>In cases like this where the replacement object is complicated, using
<code>magrittr</code> would simplify the idiom and reduce the
opportunity for error:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="fl">3</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu">`+`</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>  <span class="co"># add 100 to every element equal to 1 modulo 3</span></span>
<span><span class="va">b</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 110 - 6 x yz - 10 x^2 y + 122 z</span></span></code></pre></div>
<p>One good use for this is to “zap” small elements:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvp.html">as.mvp</a></span><span class="op">(</span><span class="st">"1 - 0.11*x + 0.005*x*y"</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 - 0.22 x + 0.01 x y + 0.0121 x^2 - 0.0011 x^2 y + 0.000025 x^2 y^2</span></span></code></pre></div>
<p>Then we can zap as follows:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">cx</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cx</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">cx</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; 1 - 0.22 x + 0.01 x y + 0.0121 x^2</span></span></code></pre></div>
<p>(I should write a method for <code><a href="https://rdrr.io/r/base/zapsmall.html" class="external-link">zapsmall()</a></code> that does
this)</p>
</div>
<div class="section level2">
<h2 id="multivariate-generating-functions">Multivariate generating functions<a class="anchor" aria-label="anchor" href="#multivariate-generating-functions"></a>
</h2>
<p>We can see the generating function for a chess knight:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/knight.html">knight</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; mvp object algebraically equal to</span></span>
<span><span class="co">#&gt; a^-2 b^-1 + a^-2 b + a^-1 b^-2 + a^-1 b^2 + a b^-2 + a b^2 + a^2 b^-1 + a^2 b</span></span></code></pre></div>
<p>How many ways are there for a 4D knight to return to its starting
square after four moves? Answer:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/constant.html">constant</a></span><span class="op">(</span><span class="fu"><a href="../reference/knight.html">knight</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12528</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hankin2022_disordR" class="csl-entry">
Hankin, Robin K. S. 2022a. <span>“Disordered Vectors in <span>R</span>:
Introducing the disordR Package.”</span> arXiv. <a href="https://doi.org/10.48550/ARXIV.2210.03856" class="external-link">https://doi.org/10.48550/ARXIV.2210.03856</a>.
</div>
<div id="ref-hankin2022_mvp" class="csl-entry">
———. 2022b. <span>“Fast Multivariate Polynomials in <span>R</span>: The
<span><code>mvp</code></span> Package.”</span> <a href="https://arxiv.org/abs/2210.15991" class="external-link uri">https://arxiv.org/abs/2210.15991</a>; arXiv. <a href="https://doi.org/10.48550/ARXIV.2210.15991" class="external-link">https://doi.org/10.48550/ARXIV.2210.15991</a>.
</div>
<div id="ref-kahle2013" class="csl-entry">
Kahle, D. 2013. <span>“Mpoly: Multivariate Polynomials in r.”</span>
<em>R Journal</em> 5 (1): 162.
</div>
<div id="ref-stroustrup1997" class="csl-entry">
Stroustrup, B. 1997. <em>The Programming Language</em>. Third. Addison
Wesley.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
