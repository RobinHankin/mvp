<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Functionality for coeffs objects — coeffs • mvp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functionality for coeffs objects — coeffs"><meta name="description" content="

Function coeffs() allows arithmetic operators to be used for
  the coefficients of multivariate polynomials, bearing in mind that the
  order of coefficients is not determined.  It uses the disord
  class of the disordR package.
&amp;#8220;Pure&amp;#8221; extraction and replacement (as in a[i] and
a[i] &amp;lt;- value) is implemented experimentally.  The code for
extraction is cute but not particularly efficient."><meta property="og:description" content="

Function coeffs() allows arithmetic operators to be used for
  the coefficients of multivariate polynomials, bearing in mind that the
  order of coefficients is not determined.  It uses the disord
  class of the disordR package.
&amp;#8220;Pure&amp;#8221; extraction and replacement (as in a[i] and
a[i] &amp;lt;- value) is implemented experimentally.  The code for
extraction is cute but not particularly efficient."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mvp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mvp.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinHankin/mvp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Functionality for <code>coeffs</code> objects</h1>

      <div class="d-none name"><code>coeffs.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Function <code><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs()</a></code> allows arithmetic operators to be used for
  the coefficients of multivariate polynomials, bearing in mind that the
  order of coefficients is not determined.  It uses the <code>disord</code>
  class of the <a href="https://CRAN.R-project.org/package=disordR" class="external-link"><span class="pkg">disordR</span></a> package.</p>
<p>“Pure” extraction and replacement (as in <code>a[i]</code> and
<code>a[i] &lt;- value</code>) is implemented experimentally.  The code for
extraction is cute but not particularly efficient.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">vars</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">powers</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Object of class <code>disord</code></p></dd>

  <dt id="arg-value">value<a class="anchor" aria-label="anchor" href="#arg-value"></a></dt>
<dd><p>Object of class <code>disord</code>, or length-1 numeric vector</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>(much of the discussion below appears in the vignette of the
  <a href="https://CRAN.R-project.org/package=disordR" class="external-link"><span class="pkg">disordR</span></a> package).</p>
<p>Accessing elements of an <code>mvp</code> object is problematic because the
  order of the terms of an <code>mvp</code> object is not well-defined.  This
  is because the <code>map</code> class of the <code>STL</code> does not specify an
  order for the key-value pairs (and indeed the actual order in which
  they are stored may be implementation dependent).  The situation is
  similar to the <code>hyper2</code> package which uses the <code>STL</code> in a
  similar way.</p>
<p>A <code>coeffs</code> object is a vector of coefficients of a <code>mvp</code>
  object.  But it is not a conventional vector; in a conventional
  vector, we can identify the first element unambiguously, and the
  second, and so on.  An <code>mvp</code> is a map from terms to coefficients,
  and a map has no intrinsic ordering: the maps</p>
<p></p><div class="sourceCode"><pre><code>{x -&gt; 1, y -&gt; 3, xy^3 -&gt; 4}</code></pre></div>

<p>and</p><div class="sourceCode"><pre><code>{xy^3 -&gt; 4, x -&gt; 1, y -&gt; 3}</code></pre></div>

<p>are the same map and correspond to the same multinomial (symbolically,
  \(x+3y+4xy^3=4xy^3+x+3y\)).  Thus the coefficients of the
  multinomial might be <code>c(1,3,4)</code> or <code>c(4,1,3)</code>, or indeed any
  ordering.  But note that any particular ordering imposes an ordering
  on the terms.  If we choose <code>c(1,3,4)</code> then the terms are
  <code>x,y,xy^3</code>, and if we choose <code>c(4,1,3)</code> the terms are
  <code>xy^3,x,y</code>.</p>
<p>In the package, <code><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs()</a></code> returns an object of class
  <code>disord</code>.  This class of object has a slot for the coefficients
  in the form of a numeric R vector, but also another slot which uses
  hash codes to prevent users from misusing the ordering of the numeric
  vector.</p>
<p>For example, a multinomial <code>x+2y+3z</code> might have coefficients
  <code>c(1,2,3)</code> or <code>c(3,1,2)</code>.  Package idiom to extract the
  coefficients of a multivariate polynomial <code>a</code> is
  <code>coeffs(a)</code>; but this cannot return a standard numeric vector
  because a numeric vector has elements in a particular order, and the
  coefficients of a multivariate polynomial are stored in an
  implementation-specific (and thus unknown) order.</p>
<p>Suppose we have two multivariate polynomials, <code>a</code> as defined as
  above with <code>a=x+2y+3z</code> and <code>b=x+3y+4z</code>.  Even though
  <code>a+b</code> is well-defined algebraically, and <code>coeffs(a+b)</code> will
  return a well-defined <code>mvp_coeffs</code> object, idiom such as
  <code>coeffs(a) + coeffs(b)</code> is not defined because there is no
  guarantee that the coefficients of the two multivariate polynomials
  are stored in the same order.  We might have
  <code>c(1,2,3)+c(1,3,4)=c(2,5,7)</code> or
  <code>c(1,2,3)+c(1,4,3)=c(2,6,6)</code>, with neither being more
  “correct” than the other.  In the package, <code>coeffs(a) +
  coeffs(b)</code> will return an error.  In the same way <code>coeffs(a) +
  1:3</code> is not defined and will return an error.  Further, idiom such as
  <code>coeffs(a) &lt;- 1:3</code> and <code>coeffs(a) &lt;- coeffs(b)</code> are not
  defined and will return an error.  However, note that <code>coeffs(a)
  + coeffs(a)</code> and <code>coeffs(a)+coeffs(a)^2</code> are fine, these
  returning a <code>mvp_coeffs</code> object specific to <code>a</code>.</p>
<p>Idiom such as <code>coeffs(a) &lt;- coeffs(a)^2</code> is fine too, for one
  does not need to know the order of the coefficients on either side, so
  long as the order is the same on both sides.  That would translate
  into idiomatic English: “the coefficient of each term of
  <code>a</code> becomes its square”; note that this operation is insensitive
  to the order of coefficients.  The whole shebang is intended to make
  idiom such as <code>coeffs(a) &lt;- coeffs(a)%%2</code> possible (so we can
  manipulate polynomials over finite rings, here
  \(\mathbb{Z}/2\mathbb{Z}\)).</p>
<p>The replacement methods are defined so that an expression like
  <code>coeffs(a)[coeffs(a) &gt; 5] &lt;- 5</code> works as expected; the English
  idiom would be “Replace any coefficient greater than 5 with 5”.</p>
<p>To fix ideas, consider <code>a &lt;- rmvp(8)</code>.  Extraction presents
  issues; consider <code>coeffs(a)&lt;5</code>.  This object has Boolean elements
  but has the same ordering ambiguity as <code>coeffs(a)</code>.  One might
  expect that we could use this to extract elements of <code>coeffs(a)</code>,
  specifically elements less than 5.  However,
  <code>coeffs(a)[coeffs(a)&lt;5]</code> in isolation is meaningless: what can be
  done with such an object?  However, it makes sense on the left hand
  side of an assignment, as long as the right hand side is a length-one
  vector.  Idiom such as</p>
<p></p><ul><li><p></p><div class="sourceCode"><pre><code><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">+</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div></li>
<li><p></p><div class="sourceCode"><pre><code><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">a</span>,<span class="fl">3</span><span class="op">)</span></span></code></pre></div></li>
</ul><p>is algebraically meaningful (“Add 4 to any element less than
  5”; “coefficients become the pairwise maximum of themselves and
  3”).  The <a href="https://CRAN.R-project.org/package=disordR" class="external-link"><span class="pkg">disordR</span></a> package uses <code>pmaxdis()</code> rather than
  <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax()</a></code> for technical reasons.</p>
<p>So the output of <code>coeffs(x)</code> is defined only up to an unknown
  rearrangement.  The same considerations apply to the output of
  <code>vars()</code>, which returns a list of character vectors in an
  undefined order, and the output of <code>powers()</code>, which returns a
  numeric list whose elements are in an undefined order.  However, even
  though the order of these three objects is undefined individually,
  their ordering is jointly consistent in the sense that the first
  element of <code>coeffs(x)</code> corresponds to the first element of
  <code>vars(x)</code> and the first element of <code>powers(x)</code>.  The
  identity of this element is not defined—but whatever it is, the
  first element of all three accessor methods refers to it.</p>
<p>Note also that a single term (something like <code>4a^3*b*c^6</code>) has
  the same issue: the variables are not stored in a well-defined order.
  This does not matter because the algebraic value of the term does not
  depend on the order in which the variables appear and this term would
  be equivalent to <code>4b*c^6*a^3</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Robin K. S. Hankin</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">5</span><span class="op">+</span><span class="fu"><a href="rmvp.html">rmvp</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mvp object algebraically equal to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 + 2 a c^2 f + 5 b + 5 b c d + 6 b d + 6 c e f^2 + 5 e^3</span>
<span class="r-in"><span><span class="op">(</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">+</span><span class="fu"><a href="rmvp.html">rmvp</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mvp object algebraically equal to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 + 6 a b + 4 a^3 c f^2 + 2 b + 3 c + 5 c d^2 e^2 + 4 d</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A disord object with hash 654c2c4102acef68a89664a25b0ac4aad030bc93 and elements</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25  4 25 25 36 36 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (in some order)</span>
<span class="r-in"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="fl">3</span>  <span class="co"># fine, all coeffs of y now modulo 3</span></span></span>
<span class="r-in"><span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mvp object algebraically equal to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 + a^3 c f^2 + 2 b + 2 c d^2 e^2 + d</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">4</span>               </span></span>
<span class="r-in"><span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mvp object algebraically equal to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 + 4 a^3 c f^2 + 4 b + 4 c d^2 e^2 + 4 d</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>          <span class="co"># not defined, will give an error</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://robinhankin.github.io/mvp/reference/coeffs.html">coeffs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="summary.html">nterms</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># not defined, will give an error</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

